SmartFusion2 use-case:
Analog input â†’ ADC â†’ FPGA (Verilog) â†’ Output (LED / digital)

Iâ€™ll give you a simple step-by-step Libero SoC tutorial using:

SmartFusion2 (because it has built-in ADC)

Analog input â†’ compare â†’ LED ON/OFF


This is exactly how mixed-signal SoC FPGA is used ðŸš€


---

ðŸ”¹ What We Will Build (Simple Project)

ðŸŽ¯ Goal

Give analog voltage (0â€“3.3V) to ADC pin

ARM / MSS ADC converts to digital

FPGA logic checks value

If voltage > threshold â†’ LED ON

Else â†’ LED OFF



---

ðŸ”¹ Requirements

Board: SmartFusion2 evaluation board (or similar)

Tool: Libero SoC + SoftConsole

Language:

Verilog (for FPGA logic)

C (small code to start ADC)




---

ðŸŸ¢ STEP 1 â€” Create New Project in Libero

1. Open Libero SoC


2. File â†’ New Project


3. Name: adc_led_demo


4. Type: SoC FPGA Design


5. Device: Example

Family: SmartFusion2

Die: M2S010 (or your board chip)



6. Finish




---

ðŸŸ¢ STEP 2 â€” Configure MSS (ARM + ADC)

This is very important.

1. In Design Flow


2. Double-click Configure MSS



This opens the MSS configurator.


---

ðŸ”¹ Enable ADC

Inside MSS:

Go to Peripherals â†’ ADC

Enable:

âœ… ADC

Select channel (example: ADC0)


Enable:

Sample rate default OK




---

ðŸ”¹ Enable GPIO (for LED)

Go to Peripherals â†’ GPIO

Enable one GPIO pin (example: GPIO_0)

Set as Output


Click Generate and close MSS.


---

ðŸŸ¢ STEP 3 â€” Add Verilog Module (FPGA Logic)

Now we write a small module that:

Takes ADC digital value

Compares with threshold

Drives LED signal



---

ðŸ”¹ Create Verilog file

Right click â†’ Create HDL â†’ Verilog Module
Name: adc_compare.v


---

ðŸ”¹ Verilog Code (Simple Comparator)

module adc_compare (
    input  wire        clk,
    input  wire [11:0] adc_data,   // 12-bit ADC output
    output reg         led
);

parameter THRESHOLD = 12'd2000;   // about mid voltage

always @(posedge clk) begin
    if (adc_data > THRESHOLD)
        led <= 1'b1;   // LED ON
    else
        led <= 1'b0;   // LED OFF
end

endmodule


---

ðŸŸ¢ STEP 4 â€” Connect ADC to FPGA Fabric

In Libero:

1. Open SmartDesign


2. You will see:

MSS block (ARM + ADC)





---

ðŸ”¹ Do connections

From MSS:

Connect ADC output bus â†’ adc_data input of your Verilog block


Connect:

Clock from MSS â†’ clk


Connect:

led output â†’ MSS GPIO pin



This connects:

Analog Pin â†’ ADC (MSS) â†’ Verilog â†’ GPIO â†’ LED


---

ðŸŸ¢ STEP 5 â€” Write Small C Code (Start ADC)

Now ARM must start the ADC.

Open SoftConsole (Microchip IDE).


---

ðŸ”¹ Example C Code (Very simple)

#include "drivers/mss_adc/mss_adc.h"
#include "drivers/mss_gpio/mss_gpio.h"

int main()
{
    MSS_GPIO_init();
    MSS_GPIO_config(MSS_GPIO_0, MSS_GPIO_OUTPUT_MODE);

    MSS_ADC_init();
    MSS_ADC_enable();

    while(1)
    {
        /* ADC runs continuously */
        /* FPGA logic automatically reads adc_data */
    }
}

(ADC hardware sends data continuously to fabric)

Program this into SmartFusion2.


---

ðŸŸ¢ STEP 6 â€” Pin Assignment (Important)

Open I/O Editor

Assign:

ADC input pin â†’ Analog input pin on board

GPIO_0 â†’ LED pin


Save constraints.


---

ðŸŸ¢ STEP 7 â€” Build Flow

In Design Flow:

1. Synthesize


2. Place and Route


3. Generate Bitstream




---

ðŸŸ¢ STEP 8 â€” Program Board

1. Open FlashPro


2. Load .job file


3. Click Program




---

ðŸŸ¢ STEP 9 â€” Test (Output View ðŸ‘€)

Now:

Apply analog voltage (potentiometer / signal generator)


ðŸ”¹ Behavior

Analog Voltage	ADC Value	LED

Low (<1.6V)	< 2000	OFF âŒ
High (>1.6V)	> 2000	ON âœ…


So when you rotate the pot:

ðŸ‘‰ LED turns ON / OFF depending on voltage

This is your output view.


---

ðŸ”¹ Block Diagram (Very Important Concept)

Analog Input
     â”‚
     â–¼
+-----------+
|   ADC     |  (inside SmartFusion2 MSS)
+-----------+
     â”‚ 12-bit digital
     â–¼
+----------------+
| Verilog Logic  |  (compare > threshold)
+----------------+
     â”‚
     â–¼
+---------+
|  GPIO   |
+---------+
     â”‚
     â–¼
   LED ON/OFF


---

ðŸ”¹ Why This Example Is VERY Valuable ðŸš€

This shows:

Mixed signal design

ADC handling

FPGA logic

ARM + FPGA co-design

